import json

relation_category_mapping = {
    # 假设的关系分类映射，需要根据实际情况进行修改或扩展
    #     "在": "位置与地理关系",
    #     "靠近": "位置与地理关系",
    #     "相遇": "位置与地理关系",
    #     "远离": "位置与地理关系",
    #     "沿着": "位置与地理关系",
    #     "沿····展布/展开": "位置与地理关系",
    "沿····展布/展开": "展开",
    #     "产于": "位置与地理关系",
    #     "距离": "位置与地理关系",
    #     "围绕": "位置与地理关系",
    #     "包围": "位置与地理关系",
    #     "···夹··": "位置与地理关系",
    "···夹··": "夹",
    #     "与···相伴": "位置与地理关系",
    "与···相伴": "相伴",
    #     "叠加在": "位置与地理关系",
    #     "集中于": "位置与地理关系",
    #     "接/临/相连": "位置与地理关系",
    "接/临/相连": "接临相连",
    #     "···之间（中）··": "位置与地理关系",
    "···之间（中）··": "之间",
    #     "以···为界": "位置与地理关系",
    "以···为界": "以界",
    #     "穿插": "位置与地理关系",
    #     "穿切": "位置与地理关系",
    #     "以···为中心": "位置与地理关系",
    "以···为中心": "中心",
    #     "延伸": "位置与地理关系",
    #     "分布于": "位置与地理关系",
    #     "平行于": "位置与地理关系",
    #     "早于": "时间次序发展关系",
    #     "晚于": "时间次序发展关系",
    #     "之前": "时间次序发展关系",
    #     "之后": "时间次序发展关系",
    #     "随着": "时间次序发展关系",
    #     "持续": "时间次序发展关系",
    #     "—>": "时间次序发展关系",
    "—>": "转到",
    #     "包含": "组成构成属性关系",
    #     "有": "组成构成属性关系",
    #     "为": "组成构成属性关系",
    #     "具有": "组成构成属性关系",
    #     "与": "组成构成属性关系",
    #     "和": "组成构成属性关系",
    #     "以及": "组成构成属性关系",
    #     "或": "组成构成属性关系",
    #     "少数": "组成构成属性关系",
    #     "多数": "组成构成属性关系",
    #     "其余": "组成构成属性关系",
    #     "分为": "组成构成属性关系",
    #     "部分": "组成构成属性关系",
    #     "...的...": "组成构成属性关系",
    "...的...": "的",
    #     "隐伏": "过程与机制",
    #     "矿化": "过程与机制",
    #     "伴生": "过程与机制",
    #     "产出": "过程与机制",
    #     "出露": "过程与机制",
    #     "迁移": "过程与机制",
    #     "富集": "过程与机制",
    #     "蚀变": "过程与机制",
    #     "充填": "过程与机制",
    #     "赋存": "过程与机制",
    #     "用": "过程与机制",
    #     "通过": "过程与机制",
    #     "侵入": "过程与机制",
    #     "过渡": "过程与机制",
    #     "共生": "过程与机制",
    #     "对": "过程与机制",
    #     "形成": "过程与机制",
    #     "发育": "过程与机制",
    #     "计算": "过程与机制",
    #     "拟合": "过程与机制",
    #     "约": "量度与比较",
    #     "大于": "量度与比较",
    #     "小于": "量度与比较",
    #     "仅/只有": "量度与比较",
    "仅/只有": "只有",
    #     "平均值": "量度与比较",
    #     "与··比较": "量度与比较",
    "与··比较": "比较",
    #     "加权": "量度与比较",
    #     "···相似···": "量度与比较",
    "···相似···": "相似",
    #     "占": "量度与比较",
    #     "一致": "量度与比较",
    #     "从": "量度与比较",
    #     "到/向": "量度与比较",
    "到/向": "到向",
    #     "主要": "量度与比较",
    #     "重要": "量度与比较",
    #     "次要/次之": "量度与比较",
    "次要/次之": "次要",
    #     "超出": "量度与比较",
    #     "说明": "条件假设与逻辑推理",
    #     "认为": "条件假设与逻辑推理",
    #     "可见/识别": "条件假设与逻辑推理",
    "可见/识别": "可见",
    #     "提供": "条件假设与逻辑推理",
    #     "以···为例": "条件假设与逻辑推理",
    "以···为例": "为例",
    #     "找寻": "条件假设与逻辑推理",
    #     "圈定": "条件假设与逻辑推理",
    #     "结果表明": "条件假设与逻辑推理",
    #     "预测/推测": "条件假设与逻辑推理",
    "预测/推测": "预测推测",
    #     "成因": "条件假设与逻辑推理",
    #     "与....有关": "条件假设与逻辑推理",
    "与....有关": "相关",
    #     "与···相关": "条件假设与逻辑推理",
    "与···相关": "相关",
    #     "刻画了，反映了": "条件假设与逻辑推理",
    #     "影响": "条件假设与逻辑推理",
    #     "控制": "条件假设与逻辑推理",
    #     "受控于": "条件假设与逻辑推理",
    #     "制作": "条件假设与逻辑推理",
    #     "利于": "条件假设与逻辑推理",
    #     "导致": "条件假设与逻辑推理",
    #     "总结": "条件假设与逻辑推理",
    #     "来源于": "条件假设与逻辑推理",
    #     "可能": "条件假设与逻辑推理",
    #     "以···为假设/条件": "条件假设与逻辑推理",
    "以···为假设/条件": "以条件",
    #     "根据····": "条件假设与逻辑推理",
    "根据····": "根据",
    #     "无/非": "条件假设与逻辑推理",
    "无/非": "无",
    "根据": "根据",
    "向": "到向",
    "出现": "在",
    "出现在": "在",
    "赋存于": "赋存",
    "组成了": "形成",
    "主要赋存于": "赋存",
    "分别赋存于": "赋存",
    "及": "和",
    "还有": "和",
    "标志": "说明",
    "交代": "相遇",
    "开始": "说明",
    "选择交代": "相遇",
    "相关": "相关",
    "属于": "为",
    "伴随": "随着",
    "与...密切相关": "相关",
    "发育在": "发育",
    "进行": "用",
    "研究": "根据",
    "表明": "说明",
    "有可能": "可能",
    "指出": "根据",
    "或许": "可能",
    "显示": "可见",
    "与···密切相关": "相关",
    "结果显示": "结果表明",
    "基本相同": "一致",
    "结果指出": "结果表明",
    "大致相同": "一致",
    "测出": "计算",
    "或者": "或",
    "引起": "导致",
    "所说": "根据",
    "的研究": "根据",
    "提出": "总结",
    "是": "为",
    "成矿压力": "具有",
    "范围为": "为",
    "包括": "包含",
    "划分为": "分为",
    "分成": "分为",
    "分布在": "分布于",
    "主要位于": "在",
    "划分成": "分为",
    "相似": "相似",
    "相像": "相似",
    "类似于": "相似",
    "类似": "相似",
    "显著亏损": "少数",
    "延展": "展开",
    "的": "的",
    "显现为": "可见",
    "以": "根据",
    "为主": "主要",
    "表现形式为": "为",
    "同时出现": "随着",
    "重叠在": "叠加在",
    "叠加": "叠加在",
    "位于": "在",
    "疊加": "叠加在",
    "处于": "在",
    "主控": "主要",
    "相互叠加": "叠加在",
    "具备": "具有",
    "同时也具有": "具有",
    "同时展现": "具有",
    "展现": "可见",
    "表现": "可见",
    "而且表现": "可见",
    "也": "和",
    "如此形成": "形成",
    "分析": "计算",
    "生成": "形成",
    "叠置": "叠加在",
    "并形成": "形成",
    "建立": "形成",
    "认同": "认为",
    "提到": "认为",
    "相信": "认为",
    "往/向": "到向",
    "推断": "预测推测",
    "很": "重要",
    "发生于": "产于",
    "显著": "重要",
    "存在": "形成",
    "平均年龄": "平均值",
    "见": "可见",
    "如图": "可见",
    "参见": "可见",
    "后": "之后",
    "老于": "晚于",
    "有着": "具有",
    "没有": "无",
    "可形成": ["可能", "形成"],
    "与...有关": "相关",
    "分布": "分布于",
    "应用": "用",
    "设定": "认为",
    "分解": "分为",
    "实施": "用",
    "对应": "对",
    "反映了": "刻画了，反映了",
    "刻画了": "刻画了，反映了",
    "以...为界": "以界",
    "反映": "刻画了，反映了",
    "与...相联系": "相关",
    "聚集": "集中于",
    "集中在": "集中于",
    "关键因素": "重要",
    "具": "具有",
    "相连": "接临相连",
    "延伸到了": ["延伸", "到向"],
    "相关联": "相关",
    "推测": "预测推测",
    "广泛分布": ["分布于", "多数"],
    "扮演重要角色": "重要",
    "用于": "用",
    "间的": "的",
    "大都分布于": ["分布", "多数"],
    "仅有一个值为": ["为", "只有"],
    "采自": "来源于",
    "比": "比较",
    "相对": "对",
    "不同": ["无", "一致"],
    "与...相似": "相似",
    "介于": "在",
    "伴随着": "随着",
    "表现为": ["为", "说明"],
    "由": "根据",
    "到": "到向",
    "缺失": "无",
    "全缺": "无",
    "零星出露": ["出露", "少数"],
    "厚": "为",
    "尤其": "主要",
    "高于": "大于",
    "含有": "包含",
    "密切相关": "相关",
    "富含": "包含",
    "有利于": "利于",
    "与··相伴": "伴生",
    "控矿构造": "控制",
    "控岩构造": "控制",
    "超过": "大于",
    "存在于": "在",
    "呈": "为",
    "切割": "穿切",
    "构成": "形成",
    "与...共生": "共生",
    "切穿": "穿切",
    "大多数": "多数",
    "发现": "可见",
    "经过": "通过",
    "经历": "通过",
    "发生在": "在",
    "大规模侵入": "侵入",
    "结合": "根据",
    "尔后": "之后",
    "以...为中心": "中心",
    "至": "到向",
    "产生": "产出",
    "预测": "预测推测",
    "走向": "为",
    "倾向": "为",
    "倾角": "为",
    "总长度": "为",
    "交切": "穿切",
    "厚度": "为",
    "未见": "无",
    "属": ["为", "的"],
    "贫": "无",
    "与...比较": "与",
    "含量": "为",
    "必要": "重要",
    "确定": "为",
    "呈现": ["为", "可见"],
    "定义为": "为",
    "利用": "用",
    "→": "转到",
    "——>": "转到",
    "排列顺序": "为",
    "暗示": "预测推测",
    "位置不一致": ["无", "一致"],
    "随": "随着",
    "岩性为": "为",
    "最厚": "为",
    "近于": "靠近",
    "局部": "部分",
    "最深": "为",
    "划分": "分为",
    "等于": "为",
    "按": "根据",
    "可视为": ["可见", "为"],
    "运用": "用",
    "得到": "具有",
    "对比": "比较",
    "条件特点": "为",
    "发育于": ["发育", "在"],
    "拥有": "具有",
    "组成": "形成",
    "预示": "说明",
    "具体表现为": "说明",
    "探讨": "认为",
    "起源于": "来源于",
    "近似于": "拟合",
    "推广到": "转到",
    "临": "接临相连",
    "偶有": "少数",
    "不到": "小于",
    "多": "多数",
    "非": "无",
    "遇到": "相遇",
    "发生": "通过",
    "并": "和",
    "贯穿": "穿切",
    "同": "和",
    "选择性交代": ["部分", "交代"],
    "含": "包含",
    "不再出现": "无",
    "尤其是": "重要",
    "主要成矿元素为":["主要", "为"],
    "均值": "平均值",
    "较": "比较",
    "推测/预测": "预测推测",
    "未检测到": "无",
    "以...为主": "主要",
    "关系密切": "重要",
    "称为": "为",
    "过程中会": "可能",
    "会": "可能",
    "自": "从",
    "增大为": "到向",
    "呈现出": "可见",
    "证明": "说明",
    "参与": "与",
    "经": "通过",
    "或许会产生": ["可能", "产出"],
    "中": "中心",
    "可能形成": ["可能", "形成"],
    "使": "用",
    "中的": "中心",
    "富集在": "富集",
    "直到": "到向",
    "伴有": "伴生",
    "失去": "无",
    "促进": "利于",
    "多为": "多数",
    "检测到": "可见",
    "由于": "根据",
    "所在": "在",
    "相对于": "对",
    "不具备": "无",
    "可能存在":  ["可能", "具有"],
    "应是": "为",
    "基础上": "在",
    "得分中": "在",
    "基于": "根据",
    "揭示": "说明",
    "有关": "相关",
    "可能反映": ["可能", "刻画了，反映了"],
    "并且": "和",
    "如": "为例",
    "分解为": "分为",
    "对应于": "为",
    "勾画出": "刻画了，反映了",
    "环抱": "包围",
    "夹持": "夹",
    "次级": "次要",
    "寻找": "找寻",
    "依据": "根据",
    "统计": "计算",
    "不在": "无",
    "落在": "在",
    "大部分": "多数",
    "表现出": "说明",
    "作为": "为",
    "对于": "对",
    "结果如": "结果表明",
    "测得": "计算",
    "亏损": "无",
    "及其": "以及",
    "纵贯": "穿插",
    "接": "接临相连",
    "沿": "沿着",
    "穿过": "通过",
    "转为": "转到",
    "终止于": "到向",
    "始于": "从",
    "体现": "说明",
    "无关": "无",
    "识别": "可见",
    "采用": "用",
    "表示": "说明",
    "未达到": "无",
    "引发": "导致",
    "排泄到": "到向",
    "转变为": "转到",
    "表现在": "说明",
    "形成于": ["形成", "在"],
    "形状": "具有",
    "其次": "次要",
    "且": "和",
    "长宽比": "为",
    "粒径": "为",
    "测定": "计算",
    "加权（数）": "加权",
    "成岩时代为": "为",
    "较集中于": "集中于",
    "成岩时代属": "为",
    "使用": "用",
    "参考": "根据",
    "均含有": "具有",
    "转向": "转到",
    "与...一致": "一致",
    "与...相近": "接临相连",
    "及其相关": "相关",
    "以...为特征": "为",
    "相当于": "一致",
    "俯冲": "到向",
    "代表": "说明",
    "因": "成因",
    "成矿的矿源": ["成因", "矿化"],
    "保持": "持续",
}

# 读取原始的jsonl文件
data = []
with open('output_RE.jsonl', 'r', encoding='utf-8') as file:
    for line in file:
        data.append(json.loads(line))

# 替换relations标签中的type，并拆分为多个关系
new_data = []
for item in data:
    new_relations = []
    for relation in item.get('relations', []):
        original_type = relation.get('type', None)
        if original_type is not None and original_type in relation_category_mapping:
            if isinstance(relation_category_mapping[original_type], list):
                # 如果映射是一个列表，则拆分成多个关系
                for new_type in relation_category_mapping[original_type]:
                    new_relation = relation.copy()
                    new_relation['type'] = new_type
                    new_relations.append(new_relation)
            else:
                # 否则，直接替换类型
                relation['type'] = relation_category_mapping[original_type]
                new_relations.append(relation)
        else:
            new_relations.append(relation)  # 没有找到映射则保留原标签
    item['relations'] = new_relations
    new_data.append(item)

# 将修改后的数据保存为新的jsonl文件
with open('out-re-reset.jsonl', 'w', encoding='utf-8') as file:
    for item in new_data:
        json_line = json.dumps(item, ensure_ascii=False)
        file.write(json_line + '\n')

print("Relation标签替换并保存为data-re-op.jsonl完成。")
